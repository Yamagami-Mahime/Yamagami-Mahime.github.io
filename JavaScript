let svgData;

document.getElementById('svgFile').addEventListener('change', function(e) {
    const file = e.target.files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
        svgData = e.target.result;
        document.getElementById('svgContainer').innerHTML = svgData;
        updateSVG();
    };
    reader.readAsText(file);
});

['complexity', 'linearity', 'amplitude', 'symmetry'].forEach(param => {
    document.getElementById(param).addEventListener('input', updateSVG);
});

function updateSVG() {
    if (!svgData) return;

    const complexity = document.getElementById('complexity').value;
    const linearity = document.getElementById('linearity').value;
    const amplitude = document.getElementById('amplitude').value;
    const symmetry = document.getElementById('symmetry').value;

    const svg = d3.select('#svgContainer svg');
    const paths = svg.selectAll('path');

    paths.each(function() {
        const path = d3.select(this);
        let d = path.attr('d');
        
        // 複雑性: パスのポイント数を調整
        d = adjustComplexity(d, complexity);
        
        // 直線性: 曲線の制御点を調整
        d = adjustLinearity(d, linearity);
        
        // 振幅: パスの各ポイントの座標を拡大縮小
        d = adjustAmplitude(d, amplitude);
        
        // 対称性: パスの左右や上下の対称性を調整
        d = adjustSymmetry(d, symmetry);

        path.attr('d', d);
    });
}

function adjustComplexity(d, complexity) {
    // 実装例: 複雑さに応じてパスのポイントを追加または削除
    return d;
}

function adjustLinearity(d, linearity) {
    // 実装例: 直線性に応じて曲線の制御点を調整
    return d;
}

function adjustAmplitude(d, amplitude) {
    // 実装例: 振幅に応じてパスの各ポイントの座標を拡大縮小
    return d;
}

function adjustSymmetry(d, symmetry) {
    // 実装例: 対称性に応じてパスの左右や上下の対称性を調整
    return d;
}

document.getElementById('saveButton').addEventListener('click', function() {
    const svgContent = document.getElementById('svgContainer').innerHTML;
    const blob = new Blob([svgContent], {type: 'image/svg+xml'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'modified_svg.svg';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
});
