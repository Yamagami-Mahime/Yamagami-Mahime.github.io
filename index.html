<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Shape Deformer</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 0;
      padding: 20px;
    }
    .shape-selector {
      display: flex;
      justify-content: space-around;
      margin-bottom: 20px;
    }
    .shape-button {
      width: 50px;
      height: 50px;
      margin: 5px;
      border: 2px solid black;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .shape-button.active {
      border-color: red;
    }
    .shape-display {
      width: 200px;
      height: 200px;
      border: 1px solid black;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
    }
    .controls {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-bottom: 20px;
    }
    .slider-control {
      margin: 10px 0;
    }
    label {
      display: block;
      margin-bottom: 5px;
    }
    .save-button {
      padding: 10px 20px;
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- Shape Selector -->
  <div class="shape-selector">
    <div class="shape-button active" onclick="selectShape('blob')">Blob</div>
    <div class="shape-button" onclick="selectShape('star')">Star</div>
    <div class="shape-button" onclick="selectShape('ellipse')">Ellipse</div>
    <div class="shape-button" onclick="selectShape('triangle')">Triangle</div>
    <div class="shape-button" onclick="selectShape('diamond')">Diamond</div>
    <div class="shape-button" onclick="selectShape('wave')">Wave</div>
  </div>

  <!-- Shape Display -->
  <div class="shape-display">
    <canvas id="shapeCanvas" width="200" height="200"></canvas>
  </div>

  <!-- Controls -->
  <div class="controls">
    <div class="slider-control">
      <label>頂点の数: <span id="vertices-label">10</span></label>
      <input type="range" id="vertices-slider" min="3" max="30" value="10" oninput="updateShape()">
    </div>
    <div class="slider-control">
      <label>角の半径: <span id="corner-radius-label">15</span>px</label>
      <input type="range" id="corner-radius-slider" min="0" max="50" value="15" oninput="updateShape()">
    </div>
    <div class="slider-control">
      <label>オブジェクト比: <span id="scale-label">50</span>%</label>
      <input type="range" id="scale-slider" min="0" max="100" value="50" oninput="updateShape()">
    </div>
    <div class="slider-control">
      <label>角度: <span id="angle-label">90</span>°</label>
      <input type="range" id="angle-slider" min="0" max="180" value="90" oninput="updateShape()">
    </div>
    <div class="slider-control">
      <label>縦横比: <span id="vertical-scale-label">50</span>%</label>
      <input type="range" id="vertical-scale-slider" min="0" max="100" value="50" oninput="updateShape()">
    </div>
  </div>

  <!-- Save as PNG Button -->
  <button class="save-button" onclick="savePng()">PNGで保存</button>

  <script>
    let selectedShape = 'blob';
    
    // Function to select a shape
    function selectShape(shape) {
      selectedShape = shape;
      document.querySelectorAll('.shape-button').forEach(button => button.classList.remove('active'));
      event.target.classList.add('active');
      updateShape();
    }

    // Function to update the shape based on slider values
    function updateShape() {
      const vertices = document.getElementById('vertices-slider').value;
      const cornerRadius = document.getElementById('corner-radius-slider').value;
      const scale = document.getElementById('scale-slider').value;
      const angle = document.getElementById('angle-slider').value;
      const verticalScale = document.getElementById('vertical-scale-slider').value;

      // Update labels
      document.getElementById('vertices-label').textContent = vertices;
      document.getElementById('corner-radius-label').textContent = cornerRadius;
      document.getElementById('scale-label').textContent = scale;
      document.getElementById('angle-label').textContent = angle;
      document.getElementById('vertical-scale-label').textContent = verticalScale;

      // Get the canvas context
      const canvas = document.getElementById('shapeCanvas');
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Draw the shape based on the selected shape and slider values
      ctx.beginPath();
      switch (selectedShape) {
        case 'blob':
          ctx.arc(100, 100, 80, 0, 2 * Math.PI); // Simple circle as an example
          break;
        case 'star':
          drawStar(ctx, 100, 100, vertices, 80, cornerRadius);
          break;
        case 'ellipse':
          ctx.ellipse(100, 100, 80, 40, angle * Math.PI / 180, 0, 2 * Math.PI);
          break;
        case 'triangle':
          drawPolygon(ctx, 100, 100, 3, 80);
          break;
        case 'diamond':
          drawPolygon(ctx, 100, 100, 4, 80);
          break;
        case 'wave':
          drawWave(ctx);
          break;
        default:
          break;
      }
      ctx.stroke();
    }

    // Helper functions to draw shapes
    function drawStar(ctx, cx, cy, spikes, outerRadius, innerRadius) {
      let rot = Math.PI / 2 * 3;
      let x = cx;
      let y = cy;
      const step = Math.PI / spikes;

      ctx.moveTo(cx, cy - outerRadius);
      for (let i = 0; i < spikes; i++) {
        x = cx + Math.cos(rot) * outerRadius;
        y = cy + Math.sin(rot) * outerRadius;
        ctx.lineTo(x, y);
        rot += step;

        x = cx + Math.cos(rot) * innerRadius;
        y = cy + Math.sin(rot) * innerRadius;
        ctx.lineTo(x, y);
        rot += step;
      }
      ctx.lineTo(cx, cy - outerRadius);
    }

    function drawPolygon(ctx, x, y, sides, radius) {
      const angle = Math.PI * 2 / sides;
      ctx.moveTo(x + radius * Math.cos(0), y + radius * Math.sin(0));
      for (let i = 1; i <= sides; i++) {
        ctx.lineTo(x + radius * Math.cos(i * angle), y + radius * Math.sin(i * angle));
      }
    }

    function drawWave(ctx) {
      ctx.moveTo(0, 100);
      ctx.quadraticCurveTo(50, 50, 100, 100);
      ctx.quadraticCurveTo(150, 150, 200, 100);
    }

    // Function to save the shape as PNG
    function savePng() {
      const canvas = document.getElementById('shapeCanvas');
      const link = document.createElement('a');
      link.download = 'shape.png';
      link.href = canvas.toDataURL();
      link.click();
    }

    // Initialize the shape on load
    window.onload = updateShape;
  </script>
</body>
</html>
